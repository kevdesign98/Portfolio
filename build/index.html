<html>

<head>
    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
    <script src="https://unpkg.com/aframe-svg-extruder@1.0.0/dist/index.min.js"></script>
</head>

<body id="main">
    <script>

        var camPosIndex = 0;
        // https://codepen.io/wiledal/embed/WvNvEq?#js-box

        // position spline
        const spline = new THREE.CatmullRomCurve3([
            new THREE.Vector3(-10, 0, 10),
            new THREE.Vector3(-5, 5, 5),
            new THREE.Vector3(0, 0, 0),
            new THREE.Vector3(5, -5, 5),
            new THREE.Vector3(10, 0, 10),
            new THREE.Vector3(5, -5, 5),
            new THREE.Vector3(0, 0, 0),
            new THREE.Vector3(-5, 5, 5),
            new THREE.Vector3(-10, 0, 10),
        ]);

        const pos_spline = new THREE.CatmullRomCurve3([
            new THREE.Vector3( -1.56 ,  2.00 ,  0.53 ),
            new THREE.Vector3( 3.50 ,  2.00 ,  -0.55 ),
            new THREE.Vector3( 4.79 ,  0.80 ,  -5.20 ),
            new THREE.Vector3( 2.06 ,  1.00 ,  -5.33 ),
            new THREE.Vector3( 4.11 ,  1.00 ,  -9.80 ),
            new THREE.Vector3( -0.37 ,  0.60 ,  -9.55 ),
            new THREE.Vector3( -2.01 ,  2.30 ,  -9.61 ),
            new THREE.Vector3( -4.56 ,  2.30 ,  -8.91 ),
            new THREE.Vector3( -3.74 ,  2.10 ,  -9.07 ),
            new THREE.Vector3( -3.10 ,  2.00 ,  -6.28 ),
            new THREE.Vector3( -4.42 ,  2.00 ,  -4.80 ),
            new THREE.Vector3( -4.57 ,  1.70 ,  -1.40 ),
            new THREE.Vector3( -1.56 ,  2.00 ,  0.53 ),

        ]);

        const rot_spline = new THREE.CatmullRomCurve3([
            new THREE.Vector3( -0.26 ,  0.01 ,  0.00 ),
            new THREE.Vector3( -0.63 ,  0.89 ,  0.00 ),
            new THREE.Vector3( -0.10 ,  1.59 ,  0.00 ),
            new THREE.Vector3( -0.06 ,  -0.01 ,  0.00 ),
            new THREE.Vector3( -0.17 ,  1.49 ,  0.00 ),
            new THREE.Vector3( -0.00 ,  1.53 ,  0.00 ),
            new THREE.Vector3( -0.03 ,  1.57 ,  0.00 ),
            new THREE.Vector3( 0.02 ,  -0.01 ,  0.00 ),
            new THREE.Vector3( -0.00 ,  1.54 ,  0.00 ),
            new THREE.Vector3( -0.01 ,  1.53 ,  0.00 ),
            new THREE.Vector3( -0.16 ,  3.16 ,  0.00 ),
            new THREE.Vector3( -0.38 ,  4.72 ,  0.00 ),
            new THREE.Vector3( -0.26 ,  0.01 ,  0.00 ),
        ]);
        

        addEventListener("wheel", (event) => {
            // console.log("pippo",event)
            camPosIndex += event.deltaY * 0.1;
            console.log(camPosIndex);
            if (camPosIndex > steps) {
                camPosIndex = 0;
            } else if (camPosIndex < 0) {
                camPosIndex = steps;
            }
        });

        const steps = 1000;

        AFRAME.registerComponent('follow', {
            tick: function (t) {
                var camera = this.el.object3D;

                /*
                camPosIndex = t * 0.1; 
                console.log(t)
                */

                // camPosIndex Ã¨ gestito dal mouse
                if (camPosIndex > steps) {
                    camPosIndex = 0;
                } else if (camPosIndex < 0) {
                    camPosIndex = steps;
                }


                var camPos = pos_spline.getPoint(camPosIndex / steps);
                var camRot = rot_spline.getPoint(camPosIndex / steps);

                camera.position.x = camPos.x;
                camera.position.y = camPos.y;
                camera.position.z = camPos.z;

                camera.rotation.x = camRot.x;
                camera.rotation.y = camRot.y;
                camera.rotation.z = camRot.z;

                // camera.lookAt(0,0,0);

            },
            update: function () {
                console.log("update!!!!")
            }
        });


        window.onkeydown = function (e) {
            if (e.keyCode == 81) {
                console.log("q");
                document.getElementById('camera').object3D.position.y += 0.1;
            }
            if (e.keyCode == 90) {
                console.log("z");
                document.getElementById('camera').object3D.position.y -= 0.1;
            }
        }

        window.onkeyup = function (e) {
            // var pressed = "h";
            // if (e.shiftKey) {
            //     pressed += " + Shift";
            // } else if (e.ctrlKey) {
            //     pressed += " + Ctrl";
            // } //and so on
            // pressed += e.keyCode;
            // console.log(pressed);
            if (e.keyCode == 72) {
                console.log("piru");
                var pos = document.getElementById('camera').object3D.position;
                var rot = document.getElementById('camera').object3D.rotation;
                // console.log(">> pos ", pos, " rot ", rot)
                console.log("position=\"",pos.x.toFixed(2)," ",pos.y.toFixed(2)," ", pos.z.toFixed(2),"\" rotation=\"",rot.x.toFixed(2)," ",rot.y.toFixed(2)," ", rot.z.toFixed(2),"\"")
                console.log("pos: new THREE.Vector3(",pos.x.toFixed(2),", ",pos.y.toFixed(2),", ", pos.z.toFixed(2),"),");
                console.log("rotaa: new THREE.Vector3(",rot.x.toFixed(2),", ",rot.y.toFixed(2),", ", rot.z.toFixed(2),"),");
            }


            console.log(e.keyCode);
        }



    </script>
    <a-scene vr-mode-ui="enabled: false">

        <a-sphere position="0 0 0" radius="0.1" color="red"></a-sphere>

        <!-- <a-asset-item id="other" src="assets/imgs/eidos.svg"></a-asset-item> -->

        <a-entity gltf-model="./assets/gltf/stanze-vuote.glb"></a-entity>
        <!-- <a-entity gltf-model="./assets/gltf/eidos.glb"></a-entity> -->
        <a-entity gltf-model="./assets/gltf/comics.glb"></a-entity>
        <!-- <a-entity id="adobeps" gltf-model="./assets/gltf/adobebox.glb"></a-entity> -->
        <a-entity scale="0.1 0.1 0.1" gltf-model="./assets/gltf/testa.min.glb"  
            animation__rotation="property: rotation; from: 0 0 0; to: 0 360 0; loop: true; dur: 5000; easing: linear"
            animation__position="property: position; from: 0 0 0; to: 0 0.2 0; loop: true; dur: 3000; easing: linear; dir: alternate"></a-entity>
        <a-sky color="#ECECEC"></a-sky>
        <a-entity follow camera position="0 2 0"></a-entity>

        <a-image id="name" scale="4.100 2.460 1.000" position="-1.524 1.401 -2.992" rotation="0 0 0" src="assets/imgs/nome-outline.svg"></a-image>       
        <a-image id="surname" scale="4.100 2.460 1.000" position="-1.494 0.975 -2.976" rotation="0 0 0" src="assets/imgs/cognome-outline.svg"></a-image>
        <a-image id="wd" scale="2.900 1.730 1.000" position="-1.447 0.650 -2.951" rotation="0 0 0" src="assets/imgs/wb-outline.svg"></a-image>
        <a-image id="comics" scale="2.210 0.390 1.000" position="-6.000 2.941 -7.626" rotation="0 90 0" src="assets/imgs/comics-outline.svg"></a-image>
        <a-image id="eidosmedia" scale="2.210 0.390 1.000" position="-6.000 2.941 -7.626" rotation="0 90 0" src="assets/imgs/eidos.svg"></a-image>
        <a-image id="ai" scale="0.500 0.500 0.500" position="0.719 1.102 -3.482" rotation="0 90 0" src="assets/imgs/illustrator.svg"></a-image>
        <a-image id="ps" scale="0.500 0.500 0.500" position="0.719 1.102 -3.889" rotation="0 90 0" src="assets/imgs/photoshop.svg"></a-image>
        <a-image id="pr" scale="0.500 0.500 0.500" position="0.719 1.102 -4.291" rotation="0 90 0" src="assets/imgs/premiere.svg"></a-image>
        <a-image id="utl" scale="1.000 1.000 1.000" position="-4.424 2.743 -10.998"rotation="0 360 0"src="assets/imgs/utl-outline.svg"></a-image>
        <a-image id="xd" scale="0.500 0.500 0.500" position="0.719 1.102 -4.665" rotation="0 90 0" src="assets/imgs/xd.svg"></a-image>
        <a-box color="tomato" position="0.7 -0.37 -3.5" depth="0.25" height="0.25" width="0.1"></a-box>

        <!-- <a-sky color="#6EBAA7"></a-sky> -->
        <!-- <a-gradient-sky material="topColor:1 1 0; bottomColor:1 0 0;"></a-gradient-sky> -->
        <a-assets>
            <img id="sky" src="assets/imgs/bg3.png">
        </a-assets>
        <a-sky src="#sky"></a-sky>

        <a-image id="eidos-ff" scale="1.92 1 1" position="-5.995 2.032 -9.807" rotation="0 90 0" src="assets/portfolio/Eidos-FF.png"></a-image>
        <a-image id="eidos-foc" scale="1.92 1 1" position="-5.995 2.032 -7.603" rotation="0 90 0" src="assets/portfolio/Eidos-FOC.png"></a-image>
        <a-image id="eidos-hp" scale="1.92 1 1" position="-5.960 2.032 -5.379" rotation="0 90 0" src="assets/portfolio/Eidos-HP.png"></a-image>
        <a-image id="utl-tco" scale="1.92 1 1" position="-4.404 2.032 -10.989" rotation="0 360 0" src="assets/portfolio/TCO.png"></a-image>


    </a-scene>
</body>

</html>